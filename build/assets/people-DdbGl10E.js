import{r,j as e,u as E,a as N}from"./app-RD4YkSLs.js";import{E as C}from"./edit-tabs-DwnU_rGx.js";import{L as f}from"./label-BALK6TZp.js";import{a as y,f as _}from"./lazy-loading-select-DxCqoid1.js";import{B as P}from"./createLucideIcon-Bh2i4FhY.js";import{T as L}from"./trash-Bhr0tWHw.js";import{E as F}from"./edit-layout-DbfRjes2.js";/* empty css            */import"./check-CguumAvl.js";import"./sheet-C8lzNEVF.js";import"./index-DnHvJ50q.js";import"./index-gSivFwI-.js";import"./select-styled-BX3MzeYj.js";import"./app-layout-QDXit8dA.js";import"./index-Bdhum9Hy.js";function T({data:s,setData:l,errors:x,processing:h}){const[n,p]=r.useState([]),[c,o]=r.useState(null);r.useEffect(()=>{console.log("fetchedPeople",n),o(null)},[n]);const[a,d]=r.useState([]),[u,m]=r.useState(null);r.useEffect(()=>{console.log("fetchedActivities",a),m(null)},[a]);const j=()=>{if(c&&u){if(s.activitiesPeople.find(i=>i.person_uuid===c.uuid&&i.activity_uuid===u.uuid))return;l("activitiesPeople",[...s.activitiesPeople,{activity_uuid:u.uuid,activity_name:u.label,person_uuid:c.uuid,person_name:c.label}]),o(null),m(null)}},b=t=>{l("activitiesPeople",s.activitiesPeople.filter(i=>i.person_uuid!==t.person_uuid||i.activity_uuid!==t.activity_uuid))},A=t=>t.reduce((v,g)=>v.find(S=>S.activity_uuid===g.activity_uuid)?v:v.concat([g]),[]);return r.useEffect(()=>{console.log("data.activitiesPeople",s.activitiesPeople)},[s.activitiesPeople]),e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx(f,{children:"Pessoa"}),e.jsx(y,{onInputChange:t=>{_({routeName:"people.fetch.options",q:t,setter:p})},options:n,onChange:t=>{o(t)},value:c}),e.jsx(f,{children:"Atividade"}),e.jsx(y,{onInputChange:t=>{_({routeName:"activities.fetch.options",q:t,setter:d})},options:a,onChange:t=>{m(t)},value:u}),e.jsx(P,{type:"button",variant:"secondary",className:"mt-2",onClick:j,children:"Adicionar"}),e.jsx("div",{className:"mt-4",children:A(s.activitiesPeople).map(t=>e.jsxs("div",{className:"flex flex-col gap-2 mb-4 p-2 border rounded-md",children:[e.jsx(f,{className:"text-lg",children:t.activity_name}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2",children:s.activitiesPeople.filter(i=>i.activity_uuid===t.activity_uuid).map(i=>e.jsxs("div",{className:"flex items-center gap-2 border p-2 rounded-md bg-secondary",children:[e.jsx("span",{children:i.person_name}),e.jsx(P,{type:"button",variant:"destructive",onClick:()=>b(i),children:e.jsx(L,{size:16})})]},t.activity_uuid+i.person_uuid))})]},"activity"+t.activity_uuid))})]})})}function V({artwork:s}){const{data:l,setData:x,post:h,processing:n}=E({activitiesPeople:s.data.people.map(o=>{var a,d;return{activity_uuid:(a=o.pivot.activity)==null?void 0:a.uuid,activity_name:(d=o.pivot.activity)==null?void 0:d.name,person_uuid:o.uuid,person_name:o.name}})}),{errors:p}=N().props,c=o=>{o.preventDefault(),h(route("artworks.update.people",s.data),{preserveScroll:!0,preserveState:!1})};return e.jsx(F,{children:e.jsxs("form",{onSubmit:c,className:"space-y-6 bg-inherit",children:[e.jsx(C,{model:s,route_base_name:"artworks",processing:n}),e.jsx(T,{data:l,setData:x,errors:p,processing:n})]})})}export{V as default};
