import{r,j as e,H as S}from"./app-RD4YkSLs.js";import{t as _}from"./type-label-CO2nTTr9.js";import{A as C}from"./app-layout-QDXit8dA.js";/* empty css            */import"./createLucideIcon-Bh2i4FhY.js";import"./sheet-C8lzNEVF.js";import"./index-DnHvJ50q.js";import"./index-gSivFwI-.js";import"./index-Bdhum9Hy.js";function G({q:h}){var p;const[b,j]=r.useState({data:[]}),[l,y]=r.useState(1),[a,c]=r.useState(0),[n,N]=r.useState([]),[o,x]=r.useState([]),v=()=>{let s=route("search.filter.fetch.options");fetch(s,{method:"GET",headers:{"Content-Type":"application/json"}}).then(t=>t.json()).then(t=>{N(t.data||[]),x(t.data.map(i=>({name:i.name,value:new Array})))}).catch(t=>console.error("Error fetching filter data:",t))};r.useEffect(()=>{v()},[]),r.useEffect(()=>{console.log("Fetched filter options:",n)},[n]),r.useEffect(()=>{console.log("Filter state updated:",o)},[o]);const u=()=>{let s=route("search.fetch.search")+`?q=${encodeURIComponent(h)}&page=${a}&filter=${encodeURIComponent(JSON.stringify(o))}`;fetch(s,{method:"GET",headers:{"Content-Type":"application/json"}}).then(t=>t.json()).then(t=>{console.log("Search results:",t),j({data:t.result}),y(t.last_page)}).catch(t=>console.error("Error fetching search results:",t))};return r.useEffect(()=>{a==1?u():c(1)},[h]),r.useEffect(()=>{if(a<1){c(1);return}if(a>l){c(l);return}u()},[a]),r.useEffect(()=>{u()},[o]),e.jsxs(C,{children:[e.jsx(S,{title:"Produções"}),e.jsx("section",{className:"px-4 py-12 text-gray-800 dark:text-gray-200",children:e.jsx("div",{className:"mx-auto lg:px-8",children:e.jsx("div",{className:"",children:e.jsxs("div",{className:"flex justify-center items-top mt-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Filtros"}),e.jsx("div",{className:"space-y-2",children:n&&n.length>0&&n.map((s,t)=>e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:s.label||""}),e.jsx("div",{className:"flex flex-col space-y-1",children:s.value.map((i,E)=>{var f,g;return e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",value:i,checked:(g=(f=o[t])==null?void 0:f.value)==null?void 0:g.includes(i),onChange:m=>{const d=[...o];m.target.checked?d[t].value.push(m.target.value):d[t].value=d[t].value.filter(F=>F!==m.target.value),x(d),c(1)},className:"mr-2"}),i]},E)})})]},t))})]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold mb-4",children:['Resultados da busca por "',h,'"']}),l>1&&e.jsxs("div",{className:"mt-6 flex justify-center items-center space-x-2",children:[e.jsx("button",{onClick:()=>c(a-1),disabled:a===1,className:`px-4 py-2 border rounded ${a===1?"text-gray-400 border-gray-300 cursor-not-allowed":"text-blue-600 border-blue-600 hover:bg-blue-100"}`,children:"Anterior"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Página ",a," de ",l]}),e.jsx("button",{onClick:s=>c(a+1),disabled:a===l,className:`px-4 py-2 border rounded ${a===l?"text-gray-400 border-gray-300 cursor-not-allowed":"text-blue-600 border-blue-600 hover:bg-blue-100"}`,children:"Próxima"})]}),e.jsx("ul",{className:"space-y-4",children:(p=b.data)==null?void 0:p.map((s,t)=>e.jsx("li",{className:"border-b pb-4",children:e.jsxs("div",{className:"flex flex-row items-center space-x-2 mb-2",children:[s.primary_image_path&&e.jsx("img",{src:s.primary_image_url||"/default-image.png",alt:s.title||s.name||"Imagem",className:"w-32 h-32 object-cover aspect-square rounded"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-gray-500",children:s.type?_(s.type):""}),e.jsx("a",{href:s.route||"#",className:"text-lg font-semibold text-blue-600 hover:underline",children:s.title||s.name||"[Sem título]"}),s.authors&&e.jsx("p",{className:"text-sm text-gray-600",children:s.authors.join(", ")}),s.content&&e.jsxs("p",{className:"text-gray-800 mt-2",children:[s.content.substring(0,150),"..."]})]})]})},t))})]})]})})})})]})}export{G as default};
